# Functional Genomics Analysis

This project analyzes various genomic and epigenetic features to distinguish between functional and non-functional RNA elements (mRNAs, lncRNAs, and sncRNAs). The analysis is conducted using R scripts and is designed to be fully reproducible.

## Project Structure

- `data/`: Contains the raw and pre-processed feature data.
- `scripts/`: Contains all the R scripts for the analysis.
- `results/`: Contains all the output generated by the analysis.
- `workflow.Rmd`: An R Markdown file that serves as the main workflow manager.
- `Dockerfile`: Defines a containerized environment for reproducibility.
- `renv.lock`: The lockfile for the `renv` package, specifying all R package dependencies.

## How to Run the Analysis

This project uses `renv` for R package management and Docker for creating a reproducible computational environment.

### Recommended Methods

#### 1. Using Docker

A `Dockerfile` is provided to create a containerized environment with all necessary system and R dependencies.

1.  **Build the Docker image:**
    ```bash
    docker build -t functional-genomics-analysis .
    ```

2.  **Run the analysis inside the container:**
    ```bash
    docker run --rm -v "$(pwd)/results:/results" functional-genomics-analysis
    ```

#### 2. Using R Markdown (Locally)

To run the analysis locally, you can use the `workflow.Rmd` file.

1.  **Restore the R Environment:**
    ```R
    renv::restore()
    ```

2.  **Run the Full Pipeline:**
    ```R
    rmarkdown::render("workflow.Rmd")
    ```

### Alternative Method

You can also run the analysis using the `run_all.R` script.

1.  **Restore the R Environment:**
    ```R
    renv::restore()
    ```
2.  **Run the Full Pipeline:**
    ```R
    source("run_all.R")
    ```

## Script Descriptions

The analysis is composed of several R scripts, which are executed in order by `workflow.Rmd` or `run_all.R`.

### Setup and Configuration

-   **`config.R`**: Defines all input and output file paths used throughout the project.
-   **`install_packages.R`**: Installs all the required R packages for the analysis. This script is not needed if you are using `renv::restore()`.
-   **`run_all.R`**: (Legacy) Master script to execute the entire analysis pipeline.
-   **`utils.R`**: Contains helper functions for data manipulation and plotting used by other scripts.

### Data Loading and Preprocessing

-   **`load_dinucleotide_features.R`**: Loads dinucleotide features and merges them with the main feature data.
-   **`load_epigenetic_features.R`**: Loads epigenetic features (histones, chromatin accessibility, methylome) and combines them into a single dataframe.
-   **`load_gene_functionality_features.R`**: Loads the primary gene functionality features.
-   **`load_gene_functionality_zscores.R`**: Helper script to load pre-computed z-scores for gene functionality features.
-   **`load_epigenetic_zscores.R`**: Helper script to load pre-computed z-scores for epigenetic features.

### Core Analysis

-   **`compute_robust_zscores.R`**: Calculates robust z-scores for all numeric features, separating data by gene type.
-   **`analize_distance_effect.R`**: Investigates the effect of genomic distance on various features using scatter plots and Spearman correlation.
-   **`mds_analisys.R`**: Performs Multidimensional Scaling (MDS) to visualize relationships between different gene types.
-   **`pca_analysis.R`**: Performs Principal Component Analysis (PCA) to visualize the separation between functional and non-functional elements.

### Visualization

-   **`generate_epigenetic_heatmap.R`**: Generates a heatmap to visualize the correlation between epigenetic features.
-   **`generate_intrinsic_heatmap.R`**: Generates a heatmap for intrinsic features (e.g., dinucleotide content).
-   **`generate_epigenetic_zscore_jitter_plots.R`**: Creates jitter plots to visualize the distribution of epigenetic z-scores.
-   **`generate_epigenetic_zscore_violin_plots.R`**: Generates violin plots to show the distribution of epigenetic z-scores.
-   **`generate_gene_functionality_zscore_violin_plots.R`**: Creates violin plots for the z-scores of the main gene functionality features.
-   **`generate_intrinsic_jitter_plots.R`**: Creates jitter plots to visualize the distribution of intrinsic z-scores.
